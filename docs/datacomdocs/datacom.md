info-center source DS channel console trap state off

# 现代数据通信的核心标准架构TCP/IP模型

- 应用层

  常见协议:HTTP、FTP、DNS、SMTP、SMB、SSH

- 传输层

  常见协议:TCP、UDP

- 网络层

  常见协议:IP、ICMP、ARP、IGMP、OSPF、BGP

- 数据链路层

  常见协议:Ethernet、IEEE 802.11(WIFI)、PPP、VLAN、STP



# 常见的数据通信设备

## 数据链路层

基于MAC地址的通信

- 二层交换机
- 无线AP
- 网络扩展卡(NIC)

## 网络层

基于IP地址的通信

- 路由器
- 无线AC控制器
- 胖AP(Fat AP)
- 三层交换机

## 网络安全设备

- 防火墙

# IPv4

IPv4地址由32位二进制数组成

```bash
二进制 11000000.10101000.00000001.00000001
十进制 192.168.1.1
```

## IPv4地址的组成部分

IPv4地址由网络号(Network ID)和主机号(Host ID)组成，通过子网掩码(Subnet Mask)划分

| 类型 | 范围                        | 用途             |
| ---- | --------------------------- | ---------------- |
| A类  | 1.0.0.0 - 126.255.255.255   | 超大型网络       |
| B类  | 128.0.0.0 - 192.255.255.255 | 中型网络         |
| C类  | 192.0.0.0 - 233.255.255.255 | 小型局域网       |
| D类  | 224.0.0.0 - 239.255.255.255 | 组播             |
| E类  | 240.0.0.0 - 255.255.255.255 | 保留用于科学研究 |

## 特殊的IPv4地址

私有地址(仅用于局域网内部使用，不直接在公网上路由)

| 范围                          | 子网掩码    |
| ----------------------------- | ----------- |
| 10.0.0.0 - 10.255.255.255     | 255.0.0.0   |
| 172.16.0.0 - 172.31.255.255   | 255.240.0.0 |
| 192.168.0.0 - 192.168.255.255 | 255.255.0.0 |

环回地址(loopback): 127.0.0.1 - 127.255.255.255 255.0.0.0(用于本机Loopback网卡的地址)

APIPA地址:169.254.0.0 - 169.254.255.255(PC无法通过DHCP获取IP时自动生成的临时地址)



## 子网划分

子网划分是将一个大的网络段切分成更小的逻辑子网，以减少广播风暴，节约IP地址

核心原理:通过子网掩码(Subnet Mask)的主机号(Host ID)借位给网络号(Network ID)



例如将IP:192.168.1.0 - 192.168.1.255,子网掩码:255.255.255.0这个网络段划分为两个逻辑子网

```bash
IP十进制:11000000.10101000.00000001.00000000 - 11000000.10101000.11111111.11111111
IP二进制:192.168.1.0 - 192.168.1.255
子网掩码十进制:255.255.255.0
子网掩码二进制:11111111.11111111.11111111.00000000
子网掩码二进制缩写CIDR(无类别域间路由):24

将其划分为两个逻辑则需要将子网掩码的主机号(Host ID)向前移一位
子网掩码十进制:255.255.255.128
子网掩码二进制:11111111.11111111.11111111.10000000
子网掩码二进制缩写CIDR(无类别域间路由):25

划分后的逻辑子网范围
--------
子网1
IP十进制:192.168.1.0 - 192.168.1.127
IP二进制:11000000.10101000.00000001.00000000 - 11000000.10101000.00000001.01111111
--------
--------
子网2
IP十进制:192.168.1.128 - 192.168.1.255
IP二进制:11000000.10101000.00000001.10000000 - 11000000.10101000.00000001.11111111

```

![子网划分测试1](./子网划分测试1.png)

![子网划分测试2](./子网划分测试2.png)

去除掉每个逻辑子网网段的网络地址和广播地址后子网1和子网2的可用地址为126个

子网1的可用地址范围为:192.168.1.1 - 192.168.1.126 网络地址:192.168.1.0 广播地址:192.168.1.127

子网2的可用地址范围为:192.168.1.129 - 192.168.1.254 网络地址:192.168.1.128 广播地址:192.168.1.255

PS:每个网段的网络位(Network ID)全为0的地址为网络地址(用于给路由器等设备标识该网段)，主机位(Host ID)全为1的地址为广播地址(当一个数据包的目的 IP 设置为广播地址时，该网段内的所有设备都会接收并处理这个包)，所以这两种地址都不可用于分配。



# VLAN(虚拟局域网)

## VLAN的核心功能

在二层网络中，交换机的通信是依靠广播转发数据给广播域中的所有设备，这会造成大量的流量占用带宽，而VLAN技术可以将广播限制在特定的逻辑组内，防止无效流量占用带宽，提升网络性能。而不同的VLAN之间的设备在二层是无法互访的，这使得网络的安全性得到了增强。

## VLAN的划分方式

- 基于设备端口的划分

​	直接指定交换机特定的端口属于哪个VLAN ID，但是设备更改了端口则需要重新配置，配置简单，最为普遍

- 基于MAC地址的划分

  指定设备的MAC地址属于哪个VLAN，如果设备更改了端口也不需要重新配置，但是录入MAC地址的工作量巨大

- 基于协议的划分

​	根据报文所属的协议类型(如IPv4,IPv6等)划分

- 基于子网的划分

  根据数据包的源IP地址网段划分



## VLAN的核心端口模式

- Access:

  主要用于连接终端设备，只允许一个唯一的VLAN，

  发送数据:会打上该端口所属的PVID(VLAN ID) Tag，如果接收到了携带Tag的数据帧，绝大多数交换机会直接丢弃

  接收数据:检查VLAN ID是否和端口的PVID一致，如果一致则会剥离数据帧的VLAN ID Tag再进行发送，如果不一致则直接丢弃数据帧。

- Trunk:

  主要用于交换机和交换机或路由器之间的连接，允许多个VLAN ID的流量通过

  发送数据:

  ①如果该数据帧的VLAN ID在端口允许通过的列表中则发送，否则不予发送

  ②如果该数据帧的VLAN ID和端口的PVID相同则剥离Tag发送，否则保持原始标签发送

  接收数据:

  ①如果是不带Tag的数据帧，则会打上本端口的PVID,然后检查该PVID是否在允许列表中，符合则接收

  ②如果是带Tag的数据帧，则检查该数据帧的VLAN ID是否在端口的允许通过列表中，允许则接收并进行后续转发，禁止则丢弃该数据帧

- Hybrid:

  主要用于复杂场景(隔离或共享网络)，结合了Access和Trunk的优点，可自行决定哪些VLAN数据帧该发，哪些该剥离标签

  发送数据:

  ①查询Untagged列表，如果数据帧的VLAN ID在这个列表里，交换机会剥离掉Tag再发送

  ②查询Tagged列表，如果数据帧的VLAN ID在这个列表里，则保留Tag原样发送

  ③如果这两个表里都没有则直接丢弃数据帧

  接收数据:

  ①收到不带Tag的数据帧，则打上本端口的PVID Tag并检查该PVID是否在端口的允许通过列表中，在列表中则接收，不在则丢弃

  ②收到带Tag的数据帧，直接检查该数据帧的VLAN ID是否在允许通过列表中，在列表中则接收，不在则丢弃



# 生成树

## 生成树的核心功能

在有冗余链路的场景中，阻塞冗余链路消除网络中可能存在的环路，且如果活动的路径发生故障时激活冗余链路，恢复网络的连通性

## STP的基本概念

### 根桥(Root Bridge)

对于一个STP网络，根桥在全网只有一个，它是整个网络的逻辑中心(但不一定是物理中心)，根桥会根据网络拓扑的变化而动态变化。当主链路发生故障激活冗余链路时，根桥会按照一定的时间间隔产生并向外发送配置BPDU，其他设备仅对该报文进行处理，传达拓扑变化记录，从而保证拓扑的稳定。

### BID(Bridge ID)

BID由16位的Bridge优先级和BridgeMAC地址组成，BID桥优先级占据高16位(其中高4位为优先级低12位为VLAN ID)，其余的低48位是MAC地址

### PID(Port ID)

PID由高4位的端口优先级和低12位的端口号组成

### 路径开销(RPC)

交换机用来衡量一条链路好坏的度量衡，带宽速度越大，开销值越小

| 链路速率 | **IEEE 802.1t (常用标准)** | **华为私有标准 (Legacy)** | **思科 Long 模式 (32位)** | **思科 Short 模式 (16位)** |
| :------- | :------------------------- | :------------------------ | :------------------------ | :------------------------- |
| 10 Mbps  | 2,000,000                  | 2,000                     | 2,000,000                 | 100                        |
| 100 Mbps | 200,000                    | 200                       | 200,000                   | 19                         |
| 1 Gbps   | 20,000                     | 20                        | 20,000                    | 4                          |
| 10 Gbps  | 2,000                      | 2                         | 2,000                     | 2                          |
| 100 Gbps | 200                        | 1                         | 200                       | 1                          |



## 选举机制

选举分为三个关键步骤，必须按顺序进行

### 一.选举根桥(Root Bridge)

根桥是整个网络的逻辑中心，所有路径计算都以此为起点

规则:

1. 先比较BID中的优先级，优先级数值最小则胜出
2. 若优先级都相同，则比较BID中的MAC地址，最小的MAC地址则胜出

### 二.选举根端口(Root Port)

非`根桥设备`需要选举出一个距离`根桥最近的端口`，负责将数据发往根桥

规则:

1. 按照到达根桥`累计的RPC(根路径开销)之和`最小的那个端口胜出
2. 若RPC相同，则比较对端交换机的BID，最小的BID则胜出
3. 若BID也相同，则比较对端发送端口的PID，最小的PID胜出
4. 若上述均相同，则比较本地接收端口的PID，最小的胜出

### 三.选举指定端口(Designated Port,DP)

每个网段必须有一个端口负责转发根桥发来的BPDU和数据流

规则:

1. 哪个端口所在的交换机距离根桥的RPC最小，该端口就是DP
2. 若RPC相同，比较该网段连接的两台交换机的BID，BID最小者的端口为DP
3. 若BID也相同，比较该网段自身的PID，PID最小端口为DP

- 根桥上所有的端口默认为指定端口

在完成上述选举后，则整个树形拓扑建立完毕。在拓扑稳定后，只有根端口和指定端口转发流量，既不是根端口，也不是指定端口的`落选端口`将被逻辑阻塞，被逻辑阻塞的端口不会转发用户数据，只接受BPDU，直到拓扑发生变化时才可能重新启用



STP端口状态

| 端口状态   | 目的                                                      | 说明                                         |
| ---------- | --------------------------------------------------------- | -------------------------------------------- |
| Forwarding | 端口既转发用户流量也处理BPDU报文。                        | 只有根端口或指定端口才能进入Forwarding状态。 |
| Learning   | 设备会根据收到的用户流量构建MAC地址表，但不转发用户流量。 | 过渡状态，增加Learning状态防止临时环路。     |
| Listening  | 确定端口角色，将选举出根桥、根端口和指定端口。            | 过渡状态。                                   |
| Blocking   | 端口仅仅接收并处理BPDU，不转发用户流量。                  | 阻塞端口的最终状态。                         |
| Disabled   | 端口不仅不处理BPDU报文，也不转发用户流量。                | 端口状态为Down。                             |



MSTP端口状态

| 端口状态   | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| Forwarding | 在这种状态下，端口既转发用户流量又处理BPDU报文。             |
| Learning   | 这是一种过渡状态。在Learning下，交换设备会根据收到的用户流量，构建MAC地址表，但不转发用户流量，所以叫做学习状态。Learning状态的端口处理BPDU报文。 |
| Discarding | Discarding状态的端口只接收BPDU报文。                         |



# 路由

## 路由的核心功能

路由是网络中数据包从源端发送至目的端所经过的路径选择过程,其本质是三层网络设备根据特定的规则在复杂的网络拓扑中为数据包寻找最优传输路径

## 关键组成部分

- 路由器:连接多个子网的硬件设备,作为网关使用。
- 路由表:路由器内部的地图,记录了去往不同网段的对应接口或下一跳地址
- 动态路由协议:计算和维护路径信息的规则,旨在基于带宽、延迟或TTL选出"最快"或"最近"的路径

## 三种主要路由类型

- 直连路由

​	给路由器的接口配置好了IP和子网掩码且接口状态为up后,路由器会自动生成通向该接口的路由。

​	直连路由只能让路由器知道直接相连的网段，如果要前往隔了另一台路由器的网段则必须依靠静态路由和动	态路由。

- 静态路由

​	需要明确指定目的端的网段，掩码以及从路由器前往目的端的下一跳或出接口。

​	由静态路由只适合简单和稳定的拓扑网络，且如果路径上的某条线路出现问题，静态路由器不会绕路，	     	数据包会被直接丢弃，除非管理员手动修改。

- 动态路由

​	路由器通过路由协议与其他路由器进行沟通，自动学习并构建路由表的过程

​	当网络出现故障时，动态路由能自动避开故障点并重新选路，无需人工干预，在大型网络中，管理员只需开	启协议，路由器会自动完成认路工作，避免手动配置的巨大工作量，且新增网络设备时，相关信息会自动在	整个网络中传播

​	

​	**常见的动态路由协议如下**

​			

| 协议名称 | 类别     | 使用场景        |
| -------- | -------- | --------------- |
| OSPF     | 内部网关 | 中大型企业内网  |
| BGP      | 外部网关 | 互联网/跨运营商 |
| RIP      | 内部网关 | 小型实验网络    |



# VLAN通信

VLAN的本质是隔离广播域,处于不同 VLAN 的设备，即使插在同一台交换机上，逻辑上也属于不同的网络，默认是无法直接通信的，要实现VLAN间的通信，必须引入路由器或三层交换机等三层网络设备进行路由转发

- 单臂路由VLAN通信方法

​	原理:路由器和交换机之间使用网线进行连接，在交换机侧配置这根网线连接的接口为trunk模式，在路由器配	置这根网线连接的接口为多个逻辑子接口，每个子接口对应一个VLAN的网关

- 三层交换机VLAN通信方法

  原理:使用带路由功能的三层交换机，为每个VLAN创建一个Vlanif接口，并在Vlanif接口上配置好IP和子网掩码。



# ACL(访问控制列表)

## 核心功能

ACL是网络设备的防火墙规则，它通过定义一系列规则，决定了哪些数据包可以放行(Permit)，那些必须丢弃(Deny)。

ACL常用于流量过滤:控制哪些用户可以访问哪些服务器。

或者用于匹配感兴趣流:在路由协议、QoS、NAT中，用ACL挑选出特定的流量进行特殊处理

## 工作原理

ACL由一系列有顺序的规则组成，当一个数据包经过了配置了ACL的接口时，则会按照规则编号进行逐条比对，一旦数据包符合某条规则，路由器就执行该规则的操作，不再看后面的规则



## ACL编号分类

| 类别          | **华为 (Huawei)** | **H3C (华三)** | **思科 (Cisco)**     | **检查内容 (核心依据)** |
| :------------ | :---------------- | :------------- | :------------------- | :---------------------- |
| **基础/标准** | 2000 - 2999       | 2000 - 2999    | 1 - 99 (及扩展段)    | 仅检查 源 IP 地址       |
| **高级/扩展** | 3000 - 3999       | 3000 - 3999    | 100 - 199 (及扩展段) | 源/目 IP、协议、端口号  |
| **二层 ACL**  | 4000 - 4999       | 4000 - 4999    | N/A (通常用 MAC ACL) | 源/目 MAC、VLAN ID      |
| **用户/命名** | 6000+ 或 命名     | 命名 ACL       | 命名 (Named) ACL     | 灵活定义，易于管理      |



## 配置三要素

1. 定义规则:写清楚`源IP`和`目的IP`,用什么协议，做什么动作

2. 通配符掩码:ACL使用反掩码(0代表必须匹配,1代表忽略)，如0.0.0.255表示匹配前三个字节

3. 应用方向:

  - Inbound:入方向，数据包进入路由器接口时检查

  - Outbound:出方向，数据包经过路由查表后，从接口发出去前检查

  基本ACL尽量靠近目的IP(因为只看源IP，放太近容易误伤其他路径)。高级ACL尽量靠近源地址(早发现早处理，节省网络            链路资源)

# AAA

## 三大核心功能

1. 认证(Authentication)

   作用:验证用户的身份

   常见手段:密码、数字证书、生物识别

2. 授权(Authorization)

   作用:根据身份分配权限，比如普通运维只能看配置(Read-only)，而管理员可以修改配置(Read-Write)

   常见手段:给不同用户下发不同的命令级别

3. 计费(Acounting)

​	作用监控并记录用户的操作行为，比如你什么时候上线的，改了哪条配置，消耗了多少流量。

​	常见用途：审计安全事故、宽带计费



## 实现方式

### 本地AAA

用户信息直接存放在路由器/交换机的内存里

优点:简单、不依赖网络。缺点:设备数量多，每台都要手动修改信息，维护繁琐

### 远程AAA

设备把认证请求发给专门的AAA服务器

优点:集中管理，更改一次信息，全网生效



# NAT网络地址转换

## 核心功能

给局域网中的私有IP转换为公网IP



## 三种转换方式

| 方案名称         | 专业术语    | 形象比喻                                                     | 适用场景                          |
| :--------------- | :---------- | :----------------------------------------------------------- | :-------------------------------- |
| 静态 NAT         | Static NAT  | 一对一：一个私网 IP 永久绑定一个公网 IP。                    | 发布内部服务器（如 Web 服务器）。 |
| 动态 NAT         | Dynamic NAT | 多对多：一堆私网 IP 轮流使用一堆公网 IP（用完归还）。        | 基本被弃用，因为还是浪费公网 IP。 |
| 网络地址端口转换 | NAPT / PAT  | 多对一：通过端口号区分不同设备（如 PC1 用 1025 端口，PC2 用 1026 端口）。 | 家庭 Wi-Fi 和企业上网             |



## 工作流程

终端访问internet时，数据包到达路由器，路由器把源地址改为自己的公网IP，并分配一个随机端口号，记录在NAT映射表里。从intelnet返回的数据包到达路由器后，路由器查表发现端口号对应的是终端，于是将目的地址改回终端的私有IP后发给终端。

# Telnet

**Telnet**（Telecommunication Network Protocol，远程终端协议）是互联网最基础的远程管理协议之一，诞生于 1969 年。它允许用户通过网络登录到另一台设备（如路由器、交换机、服务器），就像直接连接在设备的 Console 控制口上一样进行命令行操作

## 核心功能

- 远程控制：管理员无需进入机房，即可在办公室通过网络配置分布在各地的网络设备。
- 终端仿真：将本地计算机模拟成远程主机的终端。
- 端口测试：常被技术人员用来探测远程服务器的某个端口是否开放（例如：`telnet 192.168.1.1 80`）。

## 工作机制

- 传输层协议：基于 TCP 协议，默认使用 23 端口。
- C/S 架构：由 Telnet 客户端发起连接，Telnet 服务器（受管设备）响应并验证。

## 替代协议

由于Telnel有一个非常大的缺陷，即明文传输数据，因此在现代生产环境中已被SSH替代

# SSH

SSH 的核心功能可以概括为“一个核心，三个支柱”：其核心是建立安全的加密隧道，而支柱则是加密、认证与完整性

## 远程安全登录 (Secure Login)

这是 SSH 最主要的功能，用于替代 Telnet。

- **功能**：允许用户通过命令行远程管理服务器或网络设备。
- **优势**：所有传输内容（包括**用户名和密码**）都经过加密，有效防止被嗅探或中间人攻击。

## 安全文件传输 (SFTP / SCP)

基于 SSH 隧道衍生的文件管理功能。

- **SFTP (Secure FTP)**：提供类似 FTP 的交互式操作（上传、下载、新建目录），但数据流是完全加密的。
- **SCP (Secure Copy)**：用于在本地和远程主机之间快速、安全地复制文件。

## 端口转发与隧道 (Tunneling)

这是 SSH 的“高级玩法”，常用于绕过防火墙或安全加密。

- **本地转发**：将远程服务器的某个服务端口（如数据库 3306）映射到本地。
- **远程转发**：将本地服务暴露给远程服务器。
- **动态转发 (SOCKS 代理)**：通过 SSH 建立一个通用的加密代理通道。

## 强大的认证机制

- **密码认证**：传统的用户名 + 密码方式。
- **密钥对认证 (Public Key Authentication)**：使用公钥和私钥配对登录。这是目前**最安全**的推荐方式，可以实现“免密登录”且极难被暴力破解。
- 数据压缩

- **功能**：SSH 支持对传输的数据进行实时压缩（使用 Lempel-Ziv 算法）。
- **优势**：在低带宽或网络延迟较高的环境下，可以显著提高传输速度。

# DHCP

## 核心功能

自动分配IP地址:当终端设备连接网络时，DHCP服务器会自动从地址池中分配一个唯一的IP地址，避免手动配置的繁琐和冲突。

配置网络参数:除了分配IP，它还负责下发子网掩码、默认网关、DNS服务器地址等关键信息。

集中管理:管理员只需要在DHCP服务器上修改配置，即可应用到整个网络

## 工作原理

协议端口:使用UDP协议，服务器监听67端口，客户端监听68端口。

租约机制:分配的IP是有租期的，客户端需在租期过半或即将到期时向服务器申请续约，否则IP会被回收重新分配

DHCP中继:如果服务器和客户端不在同一个子网，需要通过中继代理来转发请求

以下为DHCP的工作细节:

1. Discover（发现）：客户端广播发送请求，寻找网络中的 DHCP 服务器。
2. Offer（提供）：服务器收到请求后，预留一个 IP 并发送响应（Offer）给客户端。
3. Request（请求）：客户端选择一个 Offer，并广播告知服务器它已接受该地址。
4. Ack（确认）：服务器发送确认报文，正式将该 IP 租借给客户端。

# DNS

DNS是互联网的电话篇，它将人类容易记住的域名转换为计算机识别的IP地址

## 核心功能

地址转换:主要将域名映射到IP地址。

负载均衡:通过为一个域名配置多个IP，将流量分配到不同的服务器。

邮件转发:通过MX记录指定负责接收电子邮件的服务器

## 工作流程

当你访问某个域名时，会经历以下层级查询

1. 本地缓存：浏览器和操作系统先检查自己有没有存过这个地址。
2. 递归解析器 (Recursive Resolver)：通常由你的 ISP 提供，负责跑腿去问其他服务器。
3. 根域名服务器 (Root Server)：告诉解析器去哪里找 `.com` 等顶级域。
4. 顶级域名服务器 (TLD Server)：指向具体的域名托管商（如阿里云、腾讯云）。
5. 权威域名服务器 (Authoritative Server)：给出最终的 IP 地址

常见记录类型

| 类型  | 作用                                               |
| :---- | :------------------------------------------------- |
| A     | 将域名指向一个 IPv4 地址。                         |
| AAAA  | 将域名指向一个 IPv6 地址。                         |
| CNAME | 别名记录，将一个域名指向另一个域名（常用于 CDN）。 |
| MX    | 邮件交换记录，用于邮件系统路由。                   |
| NS    | 指定由哪台服务器来解析该域名的 DNS。               |

# NTP

用于分布式时间服务器和客户端之间进行时间同步的网络协议，它确保网络中所有设备拥有统一、准确的标准时间，这对于日志升级，身份认证至关重要。

## 核心功能

高精度同步:在局域网内精度可达1ms以内，在互联网上通常能保持10ms-50ms的误差范围内

层级架构:采用分层结构来分发时间，层级越小越靠近权威时钟源

- Stratum 0:高精度时钟源(原子钟、GPS、北斗卫星)。
- Stratum 1:直接连接到Stratum 0的服务器，是网络中的主时间服务器。
- Stratum 2及以下:通过网络向上一层请求时间，最多可达15层。

容错与选择:客户端可以同时连接多个NTP服务器，利用算法剔除便宜较大的异常值，并计算出最可靠的系统时间。

## 工作原理

NTP运行在UDP协议之上，使用端口123，同步过程主要交换带有4个时间戳的报文来计算

1. 延迟 (Delay)：报文在网络中往返的总时间。
2. 偏移 (Offset)：客户端时钟与服务器时钟之间的具体差值。
   客户端根据计算结果，采取“逐步微调（Slewing）”而非“跳变”的方式修正系统时钟，以避免时间突变导致应用程序出错。

# WLAN

是指通过无线电波、激光或红外线等无线传输介质，将两台或多台设备连接起来形成的局域网络。它是对有线局域网（LAN）的延伸和补充，使用户能够在覆盖范围内自由移动并保持网络连接。



## 核心组件与架构

一个典型的 WLAN 系统主要由以下部分组成：

- 站点 (STA)：带有无线网卡的终端设备，如手机、笔记本电脑。
- 接入点 (AP)：连接无线设备与有线网络的桥梁，负责无线信号的发射与接收。
- 无线控制器 (AC)：在企业级组网中，用于集中管理和配置多个 AP。
- SSID：无线网络的名称，用户通过识别 SSID 来选择加入哪个网络

## 企业级AC+AP组网

### 核心架构与原理

- AC (Access Controller)：网络的“大脑”。负责下发配置、射频管理、安全认证及用户接入控制。它不直接发射信号，而是管理所有 AP。
- Fit AP (瘦 AP)：网络的“触角”。仅负责无线信号收发，自身不保存配置（即插即用）。所有指令均来自 AC，无法独立工作。
- PoE 交换机：通过网线同时传输数据和电力，解决 AP 的供电问题，简化布线。

### 部署模式

- 旁挂模式 (Off-path)：AC 挂在核心交换机旁边。优点是对现有网络改动小，且 AC 故障时不会影响有线业务的转发。
- 直连模式 (In-path)：AC 串联在网络主干路上。管理直接，适合规模较小的网络。
- 云化管理 (Cloud AP)：通过厂商的云平台代替本地物理 AC，适合多分支机构（如全国连锁店）的远程统一管理。

# PPP

目前应用最广泛的广域网（WAN）数据链路层协议，主要用于在全双工的同点对点链路上传输数据

## 核心功能

- 多协议支持：通过 NCP 机制，可以在同一条链路上承载多种网络层协议（如 IPv4, IPv6）。
- 身份认证：内置强大的安全机制，支持 PAP（明文）和 CHAP（挑战握手，更安全）认证。
- 易于监测：能够检测链路状态，具备循环检测（Loopback Detection）功能。

## 协议组成

PPP 协议家族由三大组件构成：

1. 封装方法：定义了如何在串行链路上封装数据帧。
2. LCP (Link Control Protocol)**：**链路控制协议。负责建立、配置、测试及拆除数据链路连接。
3. NCP (Network Control Protocol)：网络控制协议。负责协商网络层参数（如 IP 地址分配），常见的有 IPCP。

## 工作过程

PPP 链路的建立通常经历以下阶段：

- Dead 阶段：物理链路未建立时的初始状态。
- Establish 阶段：进行 LCP 协商。协商最大传输单元 (MTU)、认证方式等。
- Authenticate 阶段：进行身份验证（可选）。
- Network 阶段：进行 NCP 协商。获取 IP 地址等网络参数。
- Opened 阶段：协商完成，开始正常传输数据。

# PPPOE

PPPOE是将 PPP 协议封装在以太网框架中的技术。它简单地把 PPP 的身份认证和计费功能带到了以太网环境中，是目前最主流的家庭宽带拨号上网技术。

## 工作过程（两个阶段）

- Discovery（发现阶段）：
  - 客户端广播寻找 PPPoE 服务器（PADI）。
  - 服务器响应（PADO）。
  - 客户端请求建立连接（PADR）。
  - 服务器分配 Session ID（PADS），至此双方知道彼此的 MAC 地址和会话 ID。
- Session（会话阶段）：
  - 进入标准的 PPP 协商（LCP、认证、NCP）。
  - 协商成功后，开始进行数据传输。

## 核心优势

- 兼容性强：利用现有的廉价以太网设备（如交换机、网线）即可实现广域网接入。
- 安全性高：通过 CHAP 认证 保护用户信息。
- 部署灵活：支持大量用户共享同一条物理链路，但逻辑上相互隔离。

# SNMP

SNMP 是专门为网络设备设计的“通用语言”，让管理员能通过一套系统监控来自不同厂家（华为、思科、H3C 等）的路由器、交换机、服务器甚至打印机

## 核心角色

- NMS (管理站)：管理员面前的控制台（如 Zabbix、Prometheus 或华为 eSight）。
- Agent (代理)：运行在网络设备里的一个小程序，负责收集设备 CPU、内存、接口流量等数据。
- MIB (管理信息库)：设备的“数据字典”。它规定了数据的格式，比如“接口流量”在字典里的编号是 `1.3.6.1.2.1.2.2`（这串数字就是 OID）。

## 工作方式

SNMP 默认使用 UDP 161（查询）和 UDP 162（接收告警）端口。

SNMP 主要有三种“沟通方式”：

- 查询 (Get)：NMS 问：“1号端口流量是多少？” -> Agent 答：“100MB”。
- 设置 (Set)：NMS 命令：“关闭 2 号端口！” -> Agent 执行。
- 告警 (Trap)：Agent 主动喊：“不好了！5 号端口断开了！”（这是设备主动上报，不需要 NMS 问）。

# IPV6

# SDN

SDN（Software-Defined Networking，软件定义网络）是网络架构的一次革命性演进，其核心思想是“控制与转发分离”，将网络的“大脑”从硬件设备中提取出来，实现软件化的集中管理。

## 核心三大特征

- 控制平面与转发平面分离：传统的路由器既负责思考（协议计算）又负责干活（数据转发）；SDN 将“思考”交给了远程的控制器，硬件只负责高速转发。
- 控制平面集中化：通过 SDN 控制器获取全网的拓扑信息，像上帝视角一样统一指挥所有设备。
- 网络开放可编程：通过软件接口（API）直接操控网络行为，无需逐台登录设备配置命令行。

## 经典三层架构 

- 应用层 (Application Layer)：各种网络应用（如防火墙、负载均衡、流量监控软件）。
  - *交互接口*：北向接口 (Northbound API)，通常是 RESTful 接口。
- 控制层 (Control Layer)：SDN 的“大脑”，即 SDN 控制器（如 华为 iMaster NCE 或开源的 ONOS）。
- 基础设施层 (Infrastructure Layer)：负责转发的硬件或虚拟交换机。
  - *交互接口*：南向接口 (Southbound API)，最著名的协议是 OpenFlow，此外还有 P4、NETCONF 等。

## SDN 的核心优势

1. 业务分钟级上线：通过图形化界面批量下发配置，不再需要手动敲成百上千行 CLI。
2. 流量路径灵活调度：可以根据业务类型（如视频会议优先）实时调整链路，提高带宽利用率。
3. 自动化运维：网络能够自动感知识别故障并进行路径绕行，实现“自愈”。

# NFV

NFV（Network Functions Virtualization，网络功能虚拟化）是通过使用 x86 等标准服务器、存储和交换机，以软件形式实现传统专用硬件网络功能（如防火墙、负载均衡、路由器等）的技术。

## 核心思想

- **软硬件解耦**：打破了传统网络设备“专用软件跑在专用硬件”的绑定关系。
- **资源池化**：将通用的服务器资源打造成一个大池子，根据需求灵活分配给不同的网络功能。

## 标准架构 (ETSI NFV)

根据 ETSI (欧洲电信标准协会) 的定义，NFV 架构分为三层：

- VNF (虚拟网络功能)：具体的软件实例，比如虚拟防火墙 (vFW)、虚拟路由器 (vRouter)。
- NFVI (基础设施)：包括物理计算/存储资源，以及虚拟化层（如 KVM、VMware、Docker）。
- MANO (管理与编排)：整个系统的“指挥官”，负责 VNF 的创建、业务编排和资源监控。

## NFV vs. SDN 的区别

两者经常一起出现，但侧重点不同：

- SDN：侧重于架构创新，核心是控制与转发分离，解决的是“如何让网络管理更智能”的问题。
- NFV：侧重于设备形态创新，核心是软硬件解耦，解决的是“如何降低硬件成本和加速部署”的问题。

## 核心优势

- 降低成本 (CAPEX/OPEX)：使用通用服务器代替昂贵的专用设备，减少机房空间和能耗。
- 灵活部署：以前部署一个防火墙要走采购、物流、上架流程（数周），现在点点鼠标，几分钟内就能拉起一个 vFW。
- 弹性扩缩容：双 11 流量大时，自动增加 VNF 实例；流量低谷时，自动关闭以节省资源。
